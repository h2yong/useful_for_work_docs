# 分布式锁

## 为什么要用到分布式锁
在分布式系统中，多个进程或线程可能需要同时访问和操作同一资源。为了避免资源冲突和数据不一致的问题，引入了分布式锁。分布式锁的主要目的是确保在同一时间内，只有一个客户端能够访问共享资源，从而保证数据的一致性和系统的稳定性。

## 使用场景

- 高并发场景：例如秒杀活动中，多个用户同时抢购商品时，需要确保库存数据的准确性，避免超卖。
- 任务调度：在分布式环境中，多个节点可能同时尝试执行同一任务，分布式锁可以确保任务不会被重复执行。
- 全局资源管理：例如全局ID生成、配置文件修改等需要确保唯一性和一致性。
- 防止重复提交：在分布式系统中，避免用户重复提交表单或请求。

## 分布式锁的特性

- 互斥性：在任意时刻，只有一个客户端可以获取锁。
- 超时机制：防止死锁，锁在一定时间后会自动释放。
- 高可用性：锁的获取和释放需要高效且可靠。
- 可重入性：同一线程可以多次获取同一把锁。

## 实现方式

- Redis：通过SETNX和EXPIRE命令实现分布式锁，具有高性能和简单实现的特点。
- Zookeeper：利用临时顺序节点和watch机制实现分布式锁，适合需要强一致性的场景。
- 数据库：通过唯一索引或乐观锁实现，但性能较低。

## 总结
分布式锁是分布式系统中解决资源竞争和数据一致性问题的重要工具。根据具体场景选择合适的实现方式，可以有效提高系统的可靠性和性能。
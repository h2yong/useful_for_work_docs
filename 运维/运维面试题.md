# 运维面试题

## LVS、Nginx、HAproxy有什么区别

| 类别 | 说明 |
| ---- | ---- |
| LVS  | 基于四层的转发，只能做端口的转发，基于URL的、基于目录的这种转发LVS就做不了 |
| HAproxy | 基于四层和七层的转发，是专业的代理服务器 |
| Nginx | WEB服务器，缓存服务器，又是反向代理服务器，可以做七层的转发 |

## 什么叫CDN
* 即内容分发网络
* 其目的是通过在现有的Internet中增加一层新的网络架构，将网站的内容发布到最接近用户的网络边缘，使用户可就近取得所需的内容，提高用户访问网站的速度

## DNS进行域名解析的过程
用户要访问www.baidu.com，会先找本机的host文件，再找本地设置的DNS服务器，如果也没有的话，就去网络中找根服务器，根服务器反馈结果，说只能提供一级域名服务器.cn，就去找一级域名服务器，一级域名服务器说只能提供二级域名服务器.com.cn,就去找二级域名服务器，二级域服务器只能提供三级域名服务器.baidu.com.cn，就去找三级域名服务器，三级域名服务器正好有这个网站www.baidu.com，然后发给请求的服务器，保存一份之后，再发给客户端

## 如何修改LINUX的IP地址、网关和主机名
A. 修改IP地址、网关：编辑/etc/sysconfig/network-scripts/ifcfg-eth0，修改里面IPADDR和GATEWAY内容，没有这两行，则添加即可，添加时确保BOOTPROTO=static，静态地址，如IPADDR=192.168.1.100   GATEWAY=192.168.1.1  
B. 修改主机名称：编辑/etc/sysconfig/network，修改里面的HOSTNAME内容，如设置主机名称为mysql，则：HOSTNAME=mysql即可；

## 显示/test目录下的所有目录
* `ls -d */`
* `find . -type d -maxdepth 1`
* `ls -F | grep '/'`
* `ls -l | grep '^d'|awk '{print9}'`


## 如何查看某进程所打开的所有文件
取出该进程的进程号，然后用lsof -p pid查看打开的所有文件

## 请用iptables控制来自192.168.1.1主机的80端口请求
`iptables -A INPUT -p tcp -s 192.168.1.2 –dport 80 -j ACCEPT` (允许来自192.168.1.2这台主机访问80端口)

## mysql客户端查询工具中，如何获取当前的所有连接进程信息？
参考答案：  
`show full processlist`

## mysql如何查询数据库当前设置的最大连接数？
参考答案：  
```sql
mysql> show variables like '%max_connections%';
+-----------------+-------+
| Variable_name   | Value |
+-----------------+-------+
| max_connections | 1000  |
+-----------------+-------+
```

## Mysql查看当前连接数（连接总数、活跃数、最大并发数）

```sql
mysql> show status like 'Threads%';
+-------------------+-------+
| Variable_name     | Value |
+-------------------+-------+
| Threads_cached    | 58    |
| Threads_connected | 57    |   ###这个数值指的是打开的连接数
| Threads_created   | 3676  |
| Threads_running   | 4     |   ###这个数值指的是激活的连接数，这个数值一般远低于connected数值
+-------------------+-------+
```

Threads_connected 跟show processlist结果相同，表示当前连接数。准确的来说Threads_running是代表当前并发数

## chmod 755 a.txt，755代表什么权限？
参考答案：  
755的权限就是：rwxr-xr-x。第一位7等于4+2+1，所以就是rwx，所有者有读取、写入、执行的权限；第二位5也是4+0+1，r-x，同组用户具有读取、执行权限；第三位5，代表公共用户有读取、执行的权限。 

## umask 022代表什么意思
umask 022表示默认创建新文件权限为777-022=755

## 匹配 AAA 文本中的 key 并打印出该行及下面的 5 行？
```sh
grep -A 5 key AAA
```

注：-A 是查找关键词下面的行，-B 是查找关键词上面的行，-C 是上下的行，注意这里是 grep，而不是 find。

## top 和 ps 命令在进程占有资源率的统计方式有什么不同？
ps 命令是显示在执行 ps 这个命令时刻所有进程的情况，而 top 是动态的监控进程的情况。  
top 命令显示系统总的统计信息，比如时间、CPU 情况、 内存状态和分区信息等等。  
ps -ef 这个是一个比较常见的搭配方式，-e 是所有进程，-f 是文件之间的关系。  
ps -aux 也是很常用的，意思是显示包含其他使用者的进程。ps 命令也可以搭配 -more 和管道符使用，也可以搭配输出重定向。  
top -n 2 指的是更新两次之后就停；top -d 3 指的是更新周期是三秒；top -p 574 指的是显示 pid 为 574 的进程。top 状态下按 b 是显示高亮。  

## 符号链接与硬链接的区别？
硬链接是复制，享用同一个 inode，不能跨分区，不能连目录，a 变 b 也变，但是 a 删 b 不删。
符号链接就是 -s，不享用同一个 inode，可以跨分区可以连目录，等于快捷方式。

## 什么是正向代理和反向代理？
* 正向代理就是一个人发送一个请求直接就到达了目标的服务器
* 反方代理就是请求统一被Nginx接收，nginx反向代理服务器接收到之后，按照一定的规 则分发给了后端的业务处理服务器进行处理了

## 如何用Nginx解决前端跨域问题？
* 使用Nginx转发请求。把跨域的接口写成调本域的接口，然后将这些接口转发到真正的请求地址。

## nginx location的作用是什么？
答案参考：location指令的作用是根据用户请求的URI来执行不同的应用，也就是根据用户请求的网站URL进行匹配，匹配成功即进行相关的操作。
# SLA测试指标

## 术语定义

| 名词       | 定义                                                         |
| ---------- | ------------------------------------------------------------ |
| SLA        | 英语：service-level agreement，缩写**SLA**）也称**服务等级协议**、**服务水平协议**，是服务提供商与客户之间定义的正式[承诺](https://zh.wikipedia.org/wiki/契约)。服务提供商与受服务用户之间具体达成了承诺的服务指标——质量、可用性，责任。 |
| 系统可用性 | 系统可用性：系统可以正常使用时间与总时间（1年）之比。<br/><br/>99.9 = 8760 * 0.1% = 8760 * 0.001 = 8.76小时<br/>99.99 = 8760 * 0.0001 = 0.876小时 = 0.876 * 60 = 52.6分钟<br/>99.999 = 8760 * 0.00001 = 0.0876小时 = 0.0876 * 60 = 5.26分钟 |
| 限流       | 限制最大并发数                                               |
| 熔断       | 当错误数超过阈值时快速失败，不调用后端服务，同时隔一定时间放几个请求去重试后端服务是否能正常调用，如果成功则关闭熔断状态，失败则继续快速失败，直接返回。（此处有个重试，重试就是弹性恢复的能力） |
| 降级       | 服务失败或异常后，返回指定的默认信息                         |
| 隔离       | 把每个依赖或调用的服务都隔离开来，防止级联失败引起整体服务不可用 |
| 主动超时   | Http请求主动设置一个超时时间，超时就直接返回，不会造成服务堆积 |

## 影响SLA指标

### 主备切换能力

应用服务/中间件（含关系型数据库、NOSQL等）主备资源能否自动切换，切换过程中对业务影响时长是多少。

1. 物理架构图

### 容灾切换能力
应用服务/中间件（含关系型数据库、NOSQL等）出现容灾是否能自动切换。
1. 物理架构图；
2. 容灾如何进行恢复；

### 应用服务器弹性扩容

> 应用服务在高负载情况下能否自动扩容。

1. 扩容触发条件（CPU利用率/线程使用率/内存使用率）；

### 应用自动重启功能
> 如watchdog类似的自动重启

1. 应用是否拥有自动重启能力

### 服务高可用三大利器熔断、限流、降级

>  服务之间的依赖关系导致调用失败，解决的方式通常是: 限流->熔断->隔离->降级

**熔断**
> 应用服务是否具备熔断功能。

1. 熔断触发条件（如平均响应时间/异常比例/异常数）；
2. 熔断持续时间窗口；
3. 熔断检测时间窗口；
4. 熔断结束后检测次数；

**限流**
1. 限流匹配条件及限流门限值；
2. 限流突发量；
3. 限制类型（请求量/并发量）；
4. 是否集群限流；
5. 禁用时间；
6. 限流时间窗口；

**降级**
1. 服务等级划分，请求默认等级，当前降级等级；
2. 降级方式；
3. 降级预案；

### 黑白名单功能
**黑白名单**
1. 黑名单匹配规则；
2. 白名单匹配规则；

### 磁盘告警功能
1. 磁盘告警触发阈值；
2. 磁盘爆满后应用是否能正常运行；
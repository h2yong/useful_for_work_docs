# 判定表驱动法
## 定义
判定表是把作为条件的所有输入的各种组合值以及对应输出值都罗列出来而形成的表格。它能够将复杂的问题按照各种可能的情况全部列举出来，简明并避免遗漏。
## 判定表组成
判定表由四个部分组成，分别是条件桩(condition stub), 条件项(condition entry), 动作桩(action stub)和动作项（action entry）。
1. 条件桩是条件的列表
2. 动作桩是满足条件时系统可能产生的动作的列表
3. 条件项是条件值的组合 
4. 动作项是在条件值组合情况下发生的动作
5. 表中的每一列称为一条规则，规则定义了动作在什么条件下发生

## 分类
* 有限项判定表：每个条件只有两个值,如Y/N, T/F,1/0 等
* 扩展项判定表：条件项的取值有多个（大于2个）

## 判定表的建立步骤
1. 确定规则的个数，假如有n个条件，每个条件有两个取值（0,1）,故有2^n种规则；
2. 列出所有的条件桩和动作桩；
3. 填入条件项；
4. 填入动作项，制定初始判定表；
5. 简化、合并相似规则或相同动作。
  > 简化：就是把有两条或多条具有相同的动作、且其条件项之间存在着极为相似的关系的规则合并。

## 有限项判定表举例
### 功能描述

打印机是否能打印出来正确的内容，有多个因素影响，包括驱动程序、纸张、墨粉等。（为了简化问题，不考虑中途断电、卡纸等因素的影响）

### 参考答案
**条件桩**：

1. 驱动程序是否正确?
2. 是否有纸张？
3. 是否有墨粉？

**动作桩**：（动作桩有两种：打印内容和不同的错误提示，并且假定：优先警告缺纸，然后警告没有墨粉，最有警告驱动程序不对。）

1. 打印内容
2. 提示驱动程序不对
3. 提示没有纸张
4. 提示没有墨粉

**初始化的判定表**
<table style="width:516pt">
    <tbody>
        <tr>
            <td colspan="2">序号</td>
            <td>1</td>
            <td>2</td>
            <td>3</td>
            <td>4</td>
            <td>5</td>
            <td>6</td>
            <td>7</td>
            <td>8</td>
        </tr>
        <tr>
            <td rowspan="3">条件</td>
            <td>驱动程序是否正确？</td>
            <td>Y</td>
            <td>N</td>
            <td>Y</td>
            <td>Y</td>
            <td>N</td>
            <td>N</td>
            <td>Y</td>
            <td>N</td>
        </tr>
        <tr>
            <td>是否有纸张？</td>
            <td>Y</td>
            <td>Y</td>
            <td>N</td>
            <td>Y</td>
            <td>N</td>
            <td>Y</td>
            <td>N</td>
            <td>N</td>
        </tr>
        <tr>
            <td>是否有墨粉？</td>
            <td>Y</td>
            <td>Y</td>
            <td>Y</td>
            <td>N</td>
            <td>Y</td>
            <td>N</td>
            <td>N</td>
            <td>N</td>
        </tr>
        <tr>
            <td rowspan="4">动作</td>
            <td>打印内容</td>
            <td>✔</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td>提示驱动程序不对</td>
            <td></td>
            <td>✔</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td>提示没有纸张</td>
            <td></td>
            <td></td>
            <td>✔</td>
            <td></td>
            <td>✔</td>
            <td></td>
            <td>✔</td>
            <td>✔</td>
        </tr>
        <tr>
            <td>提示没有墨粉</td>
            <td></td>
            <td></td>
            <td></td>
            <td>✔</td>
            <td></td>
            <td>✔</td>
            <td></td>
            <td></td>
        </tr>
    </tbody>
</table>

> 注：输入条件项，即上述每个条件的值分别取“是（Y）”和“否（N）”。

**优化的判定表**

<table style="width:312pt">
    <tbody>
        <tr>
            <td colspan="2">序号</td>
            <td>1</td>
            <td>2</td>
            <td>4/6</td>
            <td>3/5/7/8</td>
        </tr>
        <tr>
            <td rowspan="3">条件</td>
            <td>驱动程序是否正确？</td>
            <td>Y</td>
            <td>N</td>
            <td>Y</td>
            <td>-</td>
        </tr>
        <tr>
            <td>是否有纸张？</td>
            <td>Y</td>
            <td>Y</td>
            <td>Y</td>
            <td>N</td>
        </tr>
        <tr>
            <td>是否有墨粉？</td>
            <td>Y</td>
            <td>Y</td>
            <td>N</td>
            <td>-</td>
        </tr>
        <tr>
            <td rowspan="4">动作</td>
            <td>打印内容</td>
            <td>✔</td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td>提示驱动程序不对</td>
            <td></td>
            <td>✔</td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td>提示没有纸张</td>
            <td></td>
            <td></td>
            <td></td>
            <td>✔</td>
        </tr>
        <tr>
            <td>提示没有墨粉</td>
            <td></td>
            <td></td>
            <td>✔</td>
            <td></td>
        </tr>
    </tbody>
</table>

> 注：  
* 如果动作结果一样，对于某些因素取“1”或“0”没有影响，即以“—”表示，并合并。
* 优化的判定表就可以设计测试用例，每一列代表一条测试用例。

**测试用例**:
- 规则1: 测试输入 = (驱动程序正确,有纸张,有墨粉), 预期结果 = “打印内容”
- 规则2: 测试输入 = (驱动程序不正确,有纸张,有墨粉), 预期结果 = “提示驱动程序不对”
- 规则3: 测试输入 = (驱动程序正确,有纸张,无墨粉), 预期结果 = “提示没有墨粉”
- 规则4: 测试输入 = (驱动程序正确,无纸张,有墨粉), 预期结果 = “提示没有纸张”

## 扩展项判断表举例
### 功能描述
NextDate（年，月，日）是三个变量的函数。函数返回输入日期的下一个日期。变量年份，月份，日期都是整数值，且满足下面的条件： 1900<=年<=2060 ,1<=月<=12, 1<=日<=31
### 参考答案
`如果你选择有限项决策表，那么表中会存在256条规则。`，故扩展项判定表来简化用例。

**首先对输入条件项进行自定义，如下：**
| 年份的有效等价类       | 月份的有效等价类                                                  | 日期的有效等价类                                         |
| ---------------------- | ----------------------------------------------------------------- | -------------------------------------------------------- |
| Y1={闰年}<br>Y2={平年} | M1={31天的月，除去12月}<br>M2={30天的月}<br>M3={2月}<br>M4={12月} | D1={从1到27}<br>D2={28}<br>D3={29}<br>D4={30}<br>D5={31} |

**NextDate问题的扩展项决策表**
<table style="width:841pt">
    <tbody>
        <tr >
            <td colspan="2">序号</td>
            <td>1</td>
            <td>2</td>
            <td>3</td>
            <td>4</td>
            <td>5</td>
            <td>6</td>
            <td>7</td>
            <td>8</td>
            <td>9</td>
            <td>10</td>
            <td>11</td>
            <td>12</td>
            <td>13</td>
        </tr>
        <tr >
            <td rowspan="3">条件</td>
            <td>月在</td>
            <td>M1</td>
            <td>M1</td>
            <td>M2</td>
            <td>M2</td>
            <td>M2</td>
            <td>M3</td>
            <td>M3</td>
            <td>M3</td>
            <td>M3</td>
            <td>M3</td>
            <td>M3</td>
            <td>M4</td>
            <td>M4</td>
        </tr>
        <tr>
            <td>日在</td>
            <td>D1,D2,D3,D4</td>
            <td>D5</td>
            <td>D1,D2,D3</td>
            <td>D4</td>
            <td>D5</td>
            <td>D1,D2</td>
            <td>D3</td>
            <td>D4,D5</td>
            <td>D1</td>
            <td>D2</td>
            <td>D3</td>
            <td>D1,D2,D3,D4</td>
            <td>D5</td>
        </tr>
        <tr >
            <td>年在</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>Y1</td>
            <td>Y1</td>
            <td>-</td>
            <td>Y2</td>
            <td>Y2</td>
            <td>Y2</td>
            <td>-</td>
            <td></td>
        </tr>
        <tr >
            <td rowspan="6">动作</td>
            <td>日期+1</td>
            <td>✔</td>
            <td></td>
            <td>✔</td>
            <td></td>
            <td></td>
            <td>✔</td>
            <td></td>
            <td></td>
            <td>✔</td>
            <td></td>
            <td></td>
            <td>✔</td>
            <td></td>
        </tr>
        <tr >
            <td>日期为1</td>
            <td></td>
            <td>✔</td>
            <td></td>
            <td>✔</td>
            <td></td>
            <td></td>
            <td>✔</td>
            <td></td>
            <td></td>
            <td>✔</td>
            <td></td>
            <td></td>
            <td>✔</td>
        </tr>
        <tr >
            <td>月份+1</td>
            <td></td>
            <td>✔</td>
            <td></td>
            <td>✔</td>
            <td></td>
            <td></td>
            <td>✔</td>
            <td></td>
            <td></td>
            <td>✔</td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr >
            <td>月份为1</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td>✔</td>
        </tr>
        <tr >
            <td>年份+1</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td>✔</td>
        </tr>
        <tr >
            <td>N/A</td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td>✔</td>
            <td></td>
            <td></td>
            <td>✔</td>
            <td></td>
            <td></td>
            <td>✔</td>
            <td></td>
            <td></td>
        </tr>
    </tbody>
</table>
**测试用例**:

- 规则1: 测试输入 = (2007,7,19), 预期结果 = “2007-7-20”
- 规则2: 测试输入 = (2007,7,31), 预期结果 = “2007-8-1”
- 规则3: 测试输入 = (2007,9,25), 预期结果 = “2007-9-26”
- 规则4: 测试输入 = (2007,9,30), 预期结果 = “2007-10-1”
- 规则5: 测试输入 = (2007,11,31)，预期结果 = “日期输入错误”
- 规则6: 测试输入 = (2000,2,15), 预期结果 = “2000-2-16”
- 规则7: 测试输入 = (2000,2,29), 预期结果 = “2000-3-1”
- 规则8: 测试输入 = (2000,2,30), 预期结果 = “日期输入错误”
- 规则9: 测试输入 = (2007,2,15), 预期结果 = “2007-2-16”
- 规则10: 测试输入 = (2007,2,28), 预期结果 = “2007-3-1”
- 规则11: 测试输入 = (2007,2,28), 预期结果 = “日期输入错误”
- 规则12: 测试输入 = (2006,12,16), 预期结果 = “2006-12-17”
- 规则13: 测试输入 = (2006,12,31), 预期结果 = “2007-1-1”


## 判定表的优/缺点:
**优点**：把复杂的问题按各种可能的情况一一列举，简明而易于理解，也避免遗漏。

**缺点**：
1. 不能表达重复执行的动作，如循环结构；
2. 判定表不能很好的伸缩。如有n个条件的判定表有2<sup>n</sup>个规则。

## 适合使用判定表设计测试用例的条件：
1. 规格说明以判定表形式给出，或很容易转换成判定表的。
2. 条件的排列顺序不会也不影响执行哪些操作。
3. 规则的排列顺序不会也不影响执行哪些操作。
4. 每当某一规则的条件已近满足，并确定要执行的操作后，不必检验别的规则。
5.  如果某一规则得到满足要执行多个操作，这些操作的执行顺序无关紧要。

> 注：对于某些不满足如上条件的判定表，同样也可以应用它来设计测试用例，只不过还要增加其他的测试用例。
# 接口幂等性测试

接口幂等性测试是验证接口在多次相同请求下是否能保持一致的正确结果（即重复调用不会产生副作用），是接口测试的重要环节。

## 明确幂等性要求

首先需确定接口是否需要保证幂等性（如查询类接口天然幂等，而创建、支付类接口通常需要幂等设计）。根据接口文档明确预期：多次相同请求应返回相同结果，且不会重复创建资源、重复扣减等；

## 核心测试场景

1. 正常重复请求测试
   同一参数多次调用：使用相同的请求参数（如订单 ID、用户信息），连续调用接口 2-3 此，验证结果是否一致。
   - 例：支付接口重复调用，不应重复扣钱，第二次调用应返回“已支付”而非再次成功。
   - 例：创建用户接口若设计为幂等（如通过唯一 ID 标识），第二次调用应返回“用户已存在”而非报错或重复创建
2. 异常重复场景测试
   1. 网络中断后重试: 模拟第一次请求发送后，客户端未收到响应（如网络超时），再次发送相同请求，验证接口是否正常处理（如识别重复请求，返回第一次处理结果）。
   2. 并非重复请求：多个相同请求同时发送（如前端重复点击提交按钮），验证接口是否可以避免并非导致的重复处理（如通过锁机制、唯一标识去重）。
3. 边界与特殊参数测试
   1. 空参数/默认参数: 对允许空值的参数，重复发送空请求，验证是否幂等。
   2. 临界值参数: 如订单金额为 0、库存边界值等，重复调用验证结果一致性。
   3. 特殊字符参数: 含特殊字符（如空格、标点、特殊字符）的请求，重复调用确认幂等性不受影响。

## 验证结果维度
1. 返回值一致性: 多次调用响应码、响应体（如状态、数据）应完全一致（除时间戳等非关键字参数）。
2. 副作用唯一性: 检查接口对后端资源的影响是否唯一（如数据库中是否只新增一条记录、缓存是否只更新一次）。
3. 幂等标识有效性: 若接口通过幂等性（如token、订单号）实现幂等，需测试该标识的有效性（如重复使用同一标识是否被识别为同一请求，使用不同标识是否正常处理）。

## 最后
总结: 接口幂等性测试的核心是"**重复请求下的结果一致性与副作用唯一性**"，需覆盖正常、异常、并非等场景，结合返回值和后端资源状态双重验证，确保接口在各种重复调用场景下的稳定性。